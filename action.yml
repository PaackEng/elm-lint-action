name: 'Elm Lint'
description: 'Lints the Elm code using elm-review and elm-format'
path:
    description: 'Path or paths to be linted'
    required: false
    default: 'src'
runs:
  using: "composite"
  steps:
     - uses: actions/checkout@v2

     - name: Setup Node
       uses: actions/setup-node@v2.1.4
       with:
        node-version: '12'

     - name: Get yarn cache directory path
       id: yarn-cache-dir-path
       run: echo "::set-output name=dir::$(yarn cache dir)"

     - uses: actions/cache@v2.1.3
       id: yarn-cache
       with:
        path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
        key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
        restore-keys: |
          ${{ runner.os }}-yarn-
     - name: Install dependencies
       run: yarn install

     - name: Run linter
       run: npx elm-format --validate ${{ inputs.path }}

     - name: Run elm-review
       run: npx elm-review ${{ inputs.path }}
